"use strict";function connect(){var e;if(!config)throw new Error("no mongo db connection provided!");return e=config.user&&config.password?format("mongodb://%s:%s@%s/%s",config.user,config.password,config.hosts,config.database):format("mongodb://%s/%s",config.hosts,config.database),mongoose.createConnection(e)}function Connection(){var e;this.connect=function(r){return e?r():(e=connect(),e.on("error",function(e){debug("MongoDB error encountered",e),process.kill(process.pid)}),e.once("close",function(){debug("MongoDB closed the connection"),process.kill(process.pid)}),void e.once("connected",function(){debug("MongoDB connected"),r()}))},Object.defineProperty(this,"db",{get:function(){return e}}),Object.defineProperty(this,"connection",{get:function(){return e}})}var mongoose=require("mongoose"),config=require("config").get("mongo"),debug=require("debug")("eye:supervisor:lib:mongodb"),format=require("util").format;module.exports=new Connection;