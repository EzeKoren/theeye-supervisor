"use strict";var config=require("config"),AWS=require("aws-sdk"),SNS=new AWS.SNS(new AWS.Config(config.aws)),request=require("request"),mailer=require("../lib/mailer"),debug=require("../lib/logger")("eye:supervisor:service:notification");module.exports={sendSNSNotification:function(e,t){if(config.get("is_dev")){var r=config.get("web-sns"),o=config.get("system").web_url+r.topicEndpoint[t.topic],n={form:{Message:JSON.stringify(e)}};debug.log("Submit Web SNS information(direct no AWS) to %s",o);request.post(o,n,function(e,t,r){e||200!=t.statusCode?(debug.error("could not connect to local web"),debug.error(e)):(debug.log("web publishing success"),debug.log(r.replace(/(\r\n|\n|\r)/gm,"")))})}else{debug.log("Submit SNS information");var i=config.get("sns");SNS.publish({TopicArn:i.topicArn[t.topic],Message:JSON.stringify(e),Subject:t.subject},function(e,t){e?debug.error(e):debug.log(t)})}},sendEmailNotification:function(e){mailer.sendMail({customer_name:e.customer_name,subject:e.subject,html:e.content,to:e.to},function(e,t){e?(debug.error("failed to send email"),debug.error(e)):debug.log("Message sent: "+JSON.stringify(t))})}};