"use strict";var mongodb=require("../../lib/mongodb"),mongoose=require("mongoose"),Schema=mongoose.Schema,properties={customer_name:{type:String,index:!0},hostname:{type:String,index:!0,required:!0},customer_id:{type:String},ip:{type:String},os_name:{type:String},os_version:{type:String},agent_version:{type:String},creation_date:{type:Date,default:Date.now},last_update:{type:Date,default:null},enable:{type:Boolean,default:!0}},EntitySchema=Schema(properties);EntitySchema.methods.publish=function(e){var t=this.toObject();return e&&e(t),t},EntitySchema.statics.create=function(e,t,r){var o={customer_name:t.name,customer_id:t._id,creation_date:new Date,last_update:new Date,hostname:e.hostname,ip:e.ip,os_name:e.os_name,os_version:e.os_version,agent_version:e.agent_version,state:e.state},n=new Entity(o);n.save(function(){r(null,n)})},EntitySchema.virtual("id").get(function(){return this._id.toHexString()});var specs={getters:!0,virtuals:!0,transform:function(e,t,r){t.id=t._id,delete t._id,delete t._type,delete t.__v}};EntitySchema.set("toJSON",specs),EntitySchema.set("toObject",specs);var Entity=mongodb.db.model("Host",EntitySchema);Entity.ensureIndexes(),exports.Entity=Entity;