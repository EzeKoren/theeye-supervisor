"use strict";var mongodb=require("../../lib/mongodb").db,BaseSchema=require("./schema"),ObjectId=require("mongoose").Schema.Types.ObjectId,logger=require("../../lib/logger")("eye:entity:monitor:template"),TemplateSchema=BaseSchema.EntitySchema.extend({template_resource:{type:ObjectId,ref:"ResourceTemplate"}});TemplateSchema.methods.update=function(e,t){var r=this;r.setUpdates(e,function(e,o){Entity.update({_id:r._id},o,function(e,r){e&&debug(e),t&&t(e,r)})})};var publishFn=BaseSchema.EntitySchema.methods.publish;TemplateSchema.methods.publish=function(e,t){var r=this;publishFn.call(this,e,function(e,o){e&&t(e),o.template_resource=r.template_resource,t(null,o)})},TemplateSchema.methods.values=function(){var e=this;return{looptime:e.looptime,config:e.config,name:e.name,type:e.type}},TemplateSchema.methods.populate=function(e){var t=this;return Entity.populate(t,"template_resource",e)};var Entity=mongodb.model("MonitorTemplate",TemplateSchema);Entity.ensureIndexes(),exports.Entity=Entity;